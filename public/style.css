:root {
  --bg: #000000;
  --bg-secondary: #1C1C1E;
  --separator: #38383A;
  --blue: #0A84FF;
  --gray-bubble: #26262A;
  --text: #FFFFFF;
  --text-secondary: #8E8E93;
  --green: #30D158;
  --red: #FF453A;
  --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

body { margin: 0; background-color: var(--bg); color: var(--text); font-family: var(--font); height: 100vh; overflow: hidden; -webkit-font-smoothing: antialiased; }
.hidden { display: none !important; }
.full-screen-center { display: flex; align-items: center; justify-content: center; height: 100%; }
button { cursor: pointer; border: none; outline: none; background: none; font-family: inherit; }

/* AUTH */
.ios-card { background: var(--bg-secondary); padding: 30px; border-radius: 20px; width: 300px; text-align: center; }
.ios-card h2 { margin-top: 0; font-weight: 700; }
.input-group { background: #2C2C2E; border-radius: 12px; overflow: hidden; margin-bottom: 15px; }
.input-group input { display: block; width: 100%; padding: 12px 15px; background: transparent; border: none; border-bottom: 1px solid var(--separator); color: white; font-size: 16px; box-sizing: border-box; }
.input-group input:last-child { border-bottom: none; }
.ios-btn { width: 100%; padding: 12px; border-radius: 12px; font-size: 17px; font-weight: 600; margin-bottom: 10px; }
.ios-btn.primary { background: var(--blue); color: white; }
.ios-btn.secondary { background: #3A3A3C; color: var(--blue); }
.divider { color: var(--text-secondary); margin: 15px 0; font-size: 13px; }

/* LAYOUT */
.ios-split-view { display: flex; height: 100%; width: 100%; }
.sidebar { width: 350px; border-right: 1px solid var(--separator); display: flex; flex-direction: column; background: var(--bg); }
.ios-header { height: 50px; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; background: rgba(28, 28, 30, 0.85); backdrop-filter: blur(20px); z-index: 10; }
.ios-header h1 { font-size: 17px; font-weight: 600; margin: 0; }
.text-btn { color: var(--blue); font-size: 17px; background: none; padding: 5px; }
.text-btn.danger { color: var(--red); }
.icon-btn { color: var(--blue); padding: 5px; display: flex; align-items: center; }

.search-wrapper { padding: 10px 15px; }
.ios-search-bar { background: #2C2C2E; border-radius: 10px; padding: 8px 10px; display: flex; align-items: center; gap: 5px; }
.ios-search-bar input { background: transparent; border: none; color: white; width: 100%; font-size: 17px; }
.ios-search-bar .search-icon { color: var(--text-secondary); }

.scroll-list { flex: 1; overflow-y: auto; padding-left: 15px; }
.friend-row { display: flex; align-items: center; padding: 12px 15px 12px 0; border-bottom: 1px solid var(--separator); cursor: pointer; }
.friend-row:hover { background: rgba(255,255,255,0.05); }
.friend-row.active { background: var(--blue); border-color: transparent; margin-left: -15px; padding-left: 15px; }
.avatar { width: 45px; height: 45px; border-radius: 50%; background: #555; color: white; display: flex; align-items: center; justify-content: center; font-weight: 500; font-size: 18px; margin-right: 12px; flex-shrink: 0; }
.friend-info { flex: 1; min-width: 0; }
.top-line { display: flex; justify-content: space-between; margin-bottom: 4px; }
.friend-name { font-weight: 600; font-size: 16px; color: var(--text); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.friend-msg { font-size: 14px; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; display: block; }

.sidebar-footer { padding: 15px; border-top: 1px solid var(--separator); display: flex; justify-content: center; align-items: center; }
.sub-text { font-size: 12px; color: var(--text-secondary); display: block; text-align: center; }

/* CHAT */
.chat-view { flex: 1; display: flex; flex-direction: column; background: #000; position: relative; }
.chat-meta { display: flex; flex-direction: column; align-items: center; flex: 1; }
.chat-name { font-size: 12px; color: var(--text-secondary); font-weight: 400; margin-bottom: 2px; }
.chat-sub { font-size: 10px; color: var(--text-secondary); }
.chat-avatar { width: 25px; height: 25px; border-radius: 50%; background: #444; display: flex; align-items: center; justify-content: center; font-size: 12px; margin-bottom: 2px; }

.message-area { flex: 1; overflow-y: auto; padding: 20px 15px; display: flex; flex-direction: column; gap: 2px; }
.empty-state { text-align: center; margin-top: 50px; color: var(--text-secondary); }

.bubble-wrap { display: flex; flex-direction: column; max-width: 70%; margin-bottom: 10px; }
.bubble-wrap.mine { align-self: flex-end; align-items: flex-end; }
.bubble-wrap.theirs { align-self: flex-start; align-items: flex-start; }
.bubble { padding: 8px 12px; border-radius: 18px; font-size: 16px; line-height: 1.4; position: relative; word-wrap: break-word; }
.mine .bubble { background: var(--blue); color: white; border-bottom-right-radius: 4px; }
.theirs .bubble { background: var(--gray-bubble); color: white; border-bottom-left-radius: 4px; }
.bubble img { max-width: 200px; border-radius: 12px; display: block; cursor: pointer; }

.composer-area { padding: 10px 15px 20px 15px; background: rgba(28, 28, 30, 0.9); backdrop-filter: blur(20px); display: flex; align-items: flex-end; gap: 10px; }
.app-store-btn { padding: 5px; color: var(--text-secondary); }
.input-pill { flex: 1; background: #2C2C2E; border-radius: 20px; padding: 5px 5px 5px 15px; display: flex; align-items: center; border: 1px solid #3A3A3C; }
.input-pill input { flex: 1; background: transparent; border: none; color: white; font-size: 16px; padding: 4px 0; }
.send-btn { width: 30px; height: 30px; background: var(--blue); border-radius: 50%; color: white; font-weight: bold; font-size: 18px; display: flex; align-items: center; justify-content: center; padding-bottom: 2px; }

/* MODAL */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100; display: flex; align-items: flex-start; justify-content: center; padding-top: 50px; }
.modal-content { background: #1C1C1E; width: 90%; max-width: 500px; border-radius: 12px; overflow: hidden; box-shadow: 0 20px 40px rgba(0,0,0,0.5); }
.modal-header { padding: 15px; text-align: center; font-weight: 600; border-bottom: 1px solid #333; position: relative; }
.modal-header button { position: absolute; right: 15px; top: 15px; font-weight: 400; }
.modal-body { padding: 0; }
.to-field { display: flex; align-items: center; padding: 10px 15px; border-bottom: 1px solid #333; }
.to-field span { color: var(--text-secondary); margin-right: 10px; }
.to-field input { background: none; border: none; color: white; flex: 1; font-size: 16px; }
.results-list { max-height: 300px; overflow-y: auto; }
.result-item { padding: 12px 15px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; }

/* ALERTS & VIDEO */
.ios-alert { background: #2C2C2E; width: 270px; border-radius: 14px; text-align: center; padding-top: 20px; backdrop-filter: blur(20px); }
.ios-alert h3 { margin: 0; font-size: 17px; }
.ios-alert p { margin: 10px 0 20px; font-size: 13px; color: var(--text-secondary); }
.alert-actions { display: flex; border-top: 1px solid rgba(255,255,255,0.15); }
.alert-btn { flex: 1; padding: 15px; font-size: 17px; color: var(--blue); border-right: 1px solid rgba(255,255,255,0.15); }
.alert-btn:last-child { border: none; font-weight: 600; }
.alert-btn.danger { color: var(--red); }
.alert-btn.safe { color: var(--green); }

#callOverlay { position: fixed; inset: 0; background: #000; z-index: 200; display: flex; flex-direction: column; }
.video-grid { flex: 1; position: relative; }
#remoteVideo { width: 100%; height: 100%; object-fit: cover; }
#localVideo { position: absolute; bottom: 100px; right: 20px; width: 100px; height: 160px; background: #333; border-radius: 12px; object-fit: cover; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
.call-controls { height: 100px; display: flex; align-items: center; justify-content: center; position: absolute; bottom: 0; width: 100%; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); }
.call-btn.end { width: 60px; height: 60px; background: var(--red); border-radius: 50%; display: flex; align-items: center; justify-content: center; }

@media (max-width: 700px) {
  .ios-split-view .sidebar { width: 100%; }
  .ios-split-view .chat-view { display: none; width: 100%; position: absolute; height: 100%; z-index: 50; }
  .ios-split-view.chat-active .sidebar { display: none; }
  .ios-split-view.chat-active .chat-view { display: flex; }
  .back-btn { display: inline-flex !important; }
}
